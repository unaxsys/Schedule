<!doctype html>
<html lang="bg">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Платформа за графици</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Планиране на смени</h1>
      <p>Управление на отдели, длъжности, графици, отпуски и болнични.</p>
      <small id="storageStatus" class="status-warn">Проверка за PostgreSQL бекенд...</small>
      <div class="api-config">
        <label for="apiUrlInput">API URL:</label>
        <input id="apiUrlInput" type="text" placeholder="http://46.183.117.128:4000" />
        <button id="saveApiUrlBtn" type="button">Свържи</button>
      </div>
    </header>

    <main class="app-layout">
      <aside class="sidebar panel">
        <h2>Навигация</h2>
        <div class="side-tabs">
          <button type="button" class="tab-btn active" data-tab="scheduleTab">График</button>
          <button type="button" class="tab-btn" data-tab="employeesTab">Служители</button>
          <button type="button" class="tab-btn" data-tab="departmentsTab">Отдели</button>
          <button type="button" class="tab-btn" data-tab="vacationTab">Отпуски</button>
          <button type="button" class="tab-btn" data-tab="rulesTab">Изчисления</button>
          <button type="button" class="tab-btn" data-tab="settingsTab">Настройки</button>
          <button type="button" class="tab-btn" data-tab="helpTab">FAQ / Help</button>
        </div>
      </aside>

      <div class="content-grid">
        <section id="scheduleTab" class="panel tab-panel active">
          <h2>Месечен график</h2>
          <div class="row">
            <label for="monthPicker">Месец:</label>
            <input id="monthPicker" type="month" />
            <button id="generateBtn" type="button">Генерирай календар</button>
          </div>

          <div class="panel" style="margin: 12px 0;">
            <h3>Графици</h3>
            <div class="schedule-controls">
              <div class="schedule-controls-row schedule-controls-row--single">
                <label for="scheduleFilterDepartmentSelect">Отдел (преглед)</label>
                <select id="scheduleFilterDepartmentSelect"></select>
              </div>
              <div class="schedule-controls-row">
                <label for="scheduleDepartmentSelect">Отдел (създаване)</label>
                <select id="scheduleDepartmentSelect"></select>
                <label for="scheduleNameInput">Име на график</label>
                <input id="scheduleNameInput" type="text" placeholder="График Общ – 2026-02" />
                <button id="createScheduleBtn" type="button">Създай график</button>
              </div>
            </div>
            <div>
              <strong>Покажи графици за месеца</strong>
              <div id="scheduleList" class="schedule-list"></div>
            </div>
          </div>

          <div class="row actions-row">
            <button id="lockScheduleBtn" type="button">Заключи графика</button>
            <button id="unlockScheduleBtn" type="button">Отключи графика</button>
            <button id="exportExcelBtn" type="button">Експорт Excel</button>
            <button id="exportPdfBtn" type="button">Експорт PDF</button>
            <span id="lockStatus" class="lock-status">Статус: Отключен</span>
          </div>
          <div id="monthInfo" class="month-info"></div>
          <div class="legend" id="shiftLegend"></div>
          <div class="table-wrap">
            <table id="scheduleTable"></table>
          </div>
        </section>

        <section id="employeesTab" class="panel tab-panel">
          <h2>Служители</h2>
          <form id="employeeForm" class="employee-form">
            <input id="firstNameInput" required placeholder="Собствено име" />
            <input id="middleNameInput" required placeholder="Бащино име" />
            <input id="lastNameInput" required placeholder="Фамилия" />
            <select id="departmentInput">
              <option value="">Без отдел</option>
            </select>
            <input id="positionInput" required placeholder="Длъжност" />
            <input id="egnInput" required maxlength="10" pattern="\d{10}" placeholder="ЕГН (10 цифри)" />
            <input id="vacationAllowanceInput" type="number" min="0" value="20" required placeholder="Годишен отпуск" />
            <button type="submit">Добави служител</button>
          </form>
          <div id="employeeList" class="employee-list"></div>
        </section>


        <section id="departmentsTab" class="panel tab-panel">
          <h2>Отдели</h2>
          <form id="departmentForm" class="row">
            <input id="departmentNameInput" required placeholder="Име на отдел" />
            <button type="submit" class="btn-add">Добави отдел</button>
          </form>
          <div id="departmentList" class="employee-list"></div>
        </section>

        <section id="vacationTab" class="panel tab-panel">
          <h2>Отпуски</h2>
          <form id="vacationForm" class="row">
            <select id="vacationEmployeeSelect" required></select>
            <input id="vacationStartInput" type="date" required />
            <input id="vacationEndInput" type="date" required />
            <button type="submit">Маркирай отпуск</button>
          </form>
          <div id="vacationLedger"></div>
        </section>

        <section id="rulesTab" class="panel tab-panel">
          <h2>Сумирано работно време и положен труд</h2>
          <p>
            Нормата за месеца = (работни дни без официални празници) × 8 ч. При СИРВ може да изберете период 1–6 месеца;
            нощните часове (22:00–06:00) се приравняват с коефициент 1.14286. Отчетът показва извънредния труд за периода.
          </p>
          <form id="ratesForm" class="row">
            <label for="weekendRateInput">Коефициент почивен ден:</label>
            <input id="weekendRateInput" type="number" min="1" step="0.05" value="1.75" />
            <label for="holidayRateInput">Коефициент официален празник:</label>
            <input id="holidayRateInput" type="number" min="1" step="0.05" value="2" />
            <label for="sirvPeriodInput">Период СИРВ (месеци):</label>
            <input id="sirvPeriodInput" type="number" min="1" max="6" step="1" value="1" />
            <button type="submit">Запази коефициенти</button>
          </form>

          <h3>Смени (начало/край)</h3>
          <form id="shiftForm" class="row">
            <input id="shiftCodeInput" maxlength="4" required placeholder="Код (напр. D1)" />
            <input id="shiftNameInput" required placeholder="Име на смяна" />
            <input id="shiftStartInput" type="time" required />
            <input id="shiftEndInput" type="time" required />
            <button type="submit">Добави смяна</button>
          </form>
          <div id="shiftList" class="shift-list"></div>
          <small>Смените „Почивка“, „Отпуск“ и „Болничен“ са системни и не се трият.</small>
        </section>

        <section id="settingsTab" class="panel tab-panel">
          <h2>Настройки</h2>
          <p>Изберете кои обобщени полета да се показват в графика:</p>
          <div id="summarySettingsList" class="settings-list"></div>
        </section>

        <section id="helpTab" class="panel tab-panel marketing-panel">
          <h2>Функционалности за администриране на работни графици</h2>
          <p>
            Ефективно планирате и разпределяте работните графици на вашите служители в пълно съответствие с българското
            законодателство.
          </p>

          <div class="marketing-columns">
            <article>
              <h3>Богата функционалност за смени и разписания</h3>
              <ul>
                <li>Динамично изчисляване на месечна норма и отчитане на дневни, нощни и извънредни часове за всеки служител.</li>
                <li>Предварително създадени шаблони (разписания) за лесно разпределяне на работните смени.</li>
                <li>Администрирате неограничен брой смени, според спецификите на работния режим.</li>
                <li>Определяте поредност на смените и цикъл на тяхната повторяемост.</li>
                <li>Планирате групово разписанията за целия екип или индивидуално чрез персонален план.</li>
                <li>Данните за отпуски, болнични, обучения и други отсъствия се виждат директно в графика на служителя.</li>
                <li>Разполагате с динамична визуализация на броя служители в една и съща смяна за конкретен календарен ден.</li>
              </ul>
            </article>

            <article>
              <h3>Автоматични контроли за съответствие</h3>
              <ul>
                <li>Междусменни почивки.</li>
                <li>Междуседмични почивки.</li>
                <li>Ограничаване на работните смени до 12 часа.</li>
                <li>Максимален обем на извънредния труд до 30 часа на месец.</li>
                <li>Общи контроли за работното време на служител за всички негови назначения.</li>
              </ul>
            </article>
          </div>

          <h3>Ползи</h3>
          <div class="benefits-grid">
            <article>
              <h4>Човешки ресурси</h4>
              <ul>
                <li>Администриране според законодателни изисквания.</li>
                <li>Автоматични проверки при приключване на периода на СИРВ.</li>
                <li>Оптимизация на извънредния труд.</li>
              </ul>
            </article>
            <article>
              <h4>Мениджър</h4>
              <ul>
                <li>Гъвкаво управление на работните графици на служителите.</li>
                <li>Актуална информация за работното време на планираните работни екипи.</li>
                <li>Следене на месечна норма.</li>
              </ul>
            </article>
            <article>
              <h4>Служител</h4>
              <ul>
                <li>Удобен индивидуален календар с визуализация на планирани и отработени смени.</li>
                <li>Навременно известяване за промени в работния график.</li>
                <li>Бързи справки и заявки.</li>
              </ul>
            </article>
          </div>

          <p class="marketing-note">
            Платформата е изградена модулно — използвате нужните функционалности сега и добавяте нови възможности
            според развитието на организацията.
          </p>
        </section>
      </div>
    </main>

    <div id="employeeEditModal" class="modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="employeeEditTitle">
      <div class="modal-card">
        <h3 id="employeeEditTitle">Редакция на служител</h3>
        <form id="employeeEditForm" class="employee-edit-form">
          <input id="editFirstNameInput" required placeholder="Собствено име" />
          <input id="editMiddleNameInput" required placeholder="Бащино име" />
          <input id="editLastNameInput" required placeholder="Фамилия" />
          <select id="editDepartmentInput">
            <option value="">Без отдел</option>
          </select>
          <input id="editPositionInput" required placeholder="Длъжност" />
          <input id="editEgnInput" required maxlength="10" pattern="\d{10}" placeholder="ЕГН (10 цифри)" />
          <input id="editVacationAllowanceInput" type="number" min="0" required placeholder="Годишен отпуск" />
          <div class="modal-actions">
            <button type="submit">Запази</button>
            <button id="cancelEmployeeEditBtn" type="button">Отказ</button>
          </div>
        </form>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
